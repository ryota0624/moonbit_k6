version: '3.8'

services:
  # Simple HTTP server for load testing
  test-server:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - ./server:/usr/share/nginx/html:ro
    networks:
      - k6-network

  # k6 load testing
  k6:
    image: grafana/k6:latest
    depends_on:
      - test-server
    volumes:
      - ./dist:/scripts:ro
    environment:
      - TEST_URL=http://test-server
    networks:
      - k6-network
    command: run /scripts/script.js

networks:
  k6-network:
    driver: bridge
